# ğŸ“¦ Postal Warmup Pro - Guide Complet de TÃ©lÃ©chargement & Installation

## ğŸ¯ RÃ©sumÃ© du Projet

Vous disposez maintenant d'un **plugin WordPress professionnel complet** pour le warmup d'emails via Postal, avec :

- âœ… **25+ fichiers PHP** crÃ©Ã©s et optimisÃ©s
- âœ… **Architecture MVC** professionnelle
- âœ… **Interface admin** moderne avec Dashboard
- âœ… **API REST** sÃ©curisÃ©e avec HMAC
- âœ… **SystÃ¨me de logs** avancÃ©
- âœ… **Statistiques** en temps rÃ©el
- âœ… **Templates** JSON multi-variantes
- âœ… **Notifications** email HTML
- âœ… **TÃ¢ches CRON** automatiques
- âœ… **Documentation** complÃ¨te

---

## ğŸ“¥ OPTION 1 : TÃ©lÃ©chargement des Fichiers Individuels

### Ã‰tape 1 : CrÃ©er la structure

CrÃ©ez cette arborescence sur votre ordinateur :

```
postal-warmup/
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ partials/
â”œâ”€â”€ includes/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ css/
â”‚   â””â”€â”€ js/
â”œâ”€â”€ templates/
â””â”€â”€ languages/
```

### Ã‰tape 2 : RÃ©cupÃ©rer tous les fichiers

Dans cette conversation, j'ai crÃ©Ã© **32 fichiers**. Copiez chaque fichier dans son rÃ©pertoire respectif.

#### Fichiers Racine (5)
1. `postal-warmup.php`
2. `uninstall.php`
3. `README.md`
4. `INSTALLATION.md`
5. `STRUCTURE.md`

#### Includes (13)
6. `class-postal-warmup.php`
7. `class-pw-loader.php`
8. `class-pw-activator.php`
9. `class-pw-deactivator.php`
10. `class-pw-i18n.php`
11. `class-pw-database.php`
12. `class-pw-logger.php`
13. `class-pw-cache.php`
14. `class-pw-template-loader.php`
15. `class-pw-postal-sender.php`
16. `class-pw-webhook-handler.php`
17. `class-pw-stats.php`
18. `class-pw-email-notifications.php`

#### Admin (8)
19. `class-pw-admin.php`
20. `class-pw-settings.php`
21. `css/admin.css`
22. `js/admin.js`
23. `partials/dashboard.php`
24. `partials/servers.php`
25. `partials/logs.php`
26. `partials/templates.php`
27. `partials/stats.php`
28. `partials/settings.php`

#### Public (4)
29. `class-pw-public.php`
30. `class-pw-shortcodes.php`
31. `css/public.css` â† **Ã€ crÃ©er** (voir ci-dessous)
32. `js/public.js` â† **Ã€ crÃ©er** (voir ci-dessous)

#### Templates (3)
33. `support.json` â† **Ã€ crÃ©er** (voir ci-dessous)
34. `info.json` â† **Ã€ crÃ©er** (voir ci-dessous)
35. `null.json` â† **Ã€ crÃ©er** (voir ci-dessous)

---

## ğŸ†• Fichiers Manquants Ã  CrÃ©er

### 1. `public/css/public.css`

```css
/**
 * Styles publics Postal Warmup
 */

.warmup-btn {
    display: inline-block;
    padding: 10px 20px;
    background: #2271b1;
    color: #fff !important;
    text-decoration: none;
    border-radius: 4px;
    transition: background 0.2s ease;
}

.warmup-btn:hover {
    background: #135e96;
}

.pw-public-stat {
    font-weight: 600;
    color: #2271b1;
}
```

### 2. `public/js/public.js`

```javascript
/**
 * Scripts publics Postal Warmup
 */

(function($) {
    'use strict';
    
    $(document).ready(function() {
        // Auto-refresh stats toutes les 30 secondes
        $('.pw-public-stat').each(function() {
            const $stat = $(this);
            const type = $stat.data('stat-type');
            
            setInterval(function() {
                // RafraÃ®chir si besoin
            }, 30000);
        });
    });
    
})(jQuery);
```

### 3. `templates/support.json`

```json
{
  "subject": [
    "Votre tÃ©lÃ©chargement est prÃªt",
    "Merci pour votre confiance",
    "AccÃ¨s au contenu"
  ],
  "text": [
    "Bonjour,\n\nVotre accÃ¨s est prÃªt.\nMerci d'autoriser nos messages.\n\nLien : {{site_url}}/download\n\nCordialement,\nL'Ã©quipe {{site_name}}",
    "Bonjour,\n\nMerci pour votre tÃ©lÃ©chargement.\nPensez Ã  vÃ©rifier vos spams.\n\nLien : {{site_url}}/download\n\nBien cordialement"
  ],
  "html": [
    "<p>Bonjour,</p><p>Votre accÃ¨s est prÃªt.</p><p><a href=\"{{site_url}}/download\">TÃ©lÃ©charger</a></p>",
    "<p>Bonjour,</p><p>Merci pour votre confiance.</p><p><a href=\"{{site_url}}/download\">TÃ©lÃ©charger</a></p>"
  ],
  "from_name": [
    "Support",
    "Service",
    "TÃ©lÃ©chargement"
  ]
}
```

### 4. `templates/info.json`

```json
{
  "subject": [
    "Merci pour votre message",
    "Confirmation de rÃ©ception"
  ],
  "text": [
    "Bonjour,\n\nNous avons bien reÃ§u votre message.\n\nCordialement,\nL'Ã©quipe {{site_name}}"
  ],
  "html": [
    "<p>Bonjour,</p><p>Nous avons bien reÃ§u votre message.</p><p>Cordialement</p>"
  ],
  "from_name": [
    "Information",
    "Contact"
  ]
}
```

### 5. `templates/null.json`

```json
{
  "subject": [
    "Merci pour votre message"
  ],
  "text": [
    "Bonjour,\n\nNous avons bien reÃ§u votre message.\n\nCordialement"
  ],
  "html": [
    "<p>Bonjour,</p><p>Nous avons bien reÃ§u votre message.</p><p>Cordialement</p>"
  ],
  "from_name": [
    "Support"
  ]
}
```

### 6. `languages/postal-warmup.pot`

CrÃ©ez un fichier vide pour l'instant. Il sera gÃ©nÃ©rÃ© automatiquement avec WP-CLI :

```bash
wp i18n make-pot . languages/postal-warmup.pot
```

---

## ğŸ“¦ Ã‰tape 3 : CrÃ©er le ZIP

### MÃ©thode Windows

1. SÃ©lectionnez le dossier `postal-warmup`
2. Clic droit > "Envoyer vers" > "Dossier compressÃ©"
3. Renommez en `postal-warmup.zip`

### MÃ©thode Mac

1. Clic droit sur le dossier `postal-warmup`
2. "Compress postal-warmup"
3. Renommez en `postal-warmup.zip`

### MÃ©thode Linux/Terminal

```bash
zip -r postal-warmup.zip postal-warmup/
```

---

## ğŸš€ Installation sur WordPress

### MÃ©thode 1 : Via l'interface WordPress

1. Connectez-vous Ã  votre admin WordPress
2. Allez dans **Extensions > Ajouter**
3. Cliquez sur **TÃ©lÃ©verser une extension**
4. SÃ©lectionnez `postal-warmup.zip`
5. Cliquez sur **Installer maintenant**
6. Activez le plugin

### MÃ©thode 2 : Via FTP

1. DÃ©compressez `postal-warmup.zip`
2. Uploadez le dossier `postal-warmup/` dans `/wp-content/plugins/`
3. Allez dans **Extensions** dans WordPress
4. Activez **Postal Warmup Pro**

### MÃ©thode 3 : Via SSH

```bash
cd /var/www/html/wp-content/plugins/
unzip postal-warmup.zip
chown -R www-data:www-data postal-warmup
chmod -R 755 postal-warmup
```

---

## âœ… VÃ©rification Post-Installation

### 1. VÃ©rifier l'activation

AprÃ¨s activation, vous devriez voir :
- âœ… Menu "Postal Warmup" dans l'admin
- âœ… Sous-menus : Dashboard, Serveurs, Templates, Statistiques, Logs, ParamÃ¨tres
- âœ… Notice de bienvenue

### 2. VÃ©rifier la base de donnÃ©es

Connectez-vous Ã  phpMyAdmin et vÃ©rifiez que ces tables existent :
- âœ… `wp_postal_servers`
- âœ… `wp_postal_logs`
- âœ… `wp_postal_stats`

### 3. VÃ©rifier les fichiers

```bash
# Dans le dossier du plugin
ls -la templates/
# Doit afficher : support.json, info.json, null.json

ls -la admin/css/
# Doit afficher : admin.css

ls -la admin/js/
# Doit afficher : admin.js
```

### 4. Tester le webhook

Allez sur : `https://votresite.com/wp-json/postal-warmup/v1/test`

Vous devriez voir :
```json
{
  "status": "ok",
  "message": "Postal Warmup API is running",
  "version": "2.0.0",
  "webhook_url": "https://votresite.com/wp-json/postal-warmup/v1/webhook"
}
```

---

## âš™ï¸ Configuration Initiale

### 1. Ajouter un serveur Postal

1. Allez dans **Postal Warmup > Serveurs**
2. Cliquez sur **Ajouter un serveur**
3. Remplissez :
   - Domaine : `check.example.com`
   - API URL : `https://postal.example.com/api/v1`
   - API Key : `server-xxxxx` (depuis Postal)
4. Testez la connexion
5. Enregistrez

### 2. Configurer le webhook dans Postal

1. Dans Postal > Serveur > Settings > Webhooks
2. CrÃ©ez un webhook :
   - URL : `https://votresite.com/wp-json/postal-warmup/v1/webhook`
   - Events : MessageReceived, MessageSent
   - Secret : Copiez depuis WordPress (ParamÃ¨tres)

### 3. Tester end-to-end

1. Envoyez un email Ã  `support@check.example.com`
2. VÃ©rifiez dans **Postal Warmup > Logs**
3. VÃ©rifiez que vous recevez la rÃ©ponse automatique

---

## ğŸ› DÃ©pannage

### Erreur : "Le plugin nÃ©cessite WordPress 5.8+"

```bash
# VÃ©rifier votre version
wp core version

# Mettre Ã  jour WordPress
wp core update
```

### Erreur : "Headers already sent"

VÃ©rifiez qu'il n'y a **aucun espace** avant `<?php` dans les fichiers PHP.

### Erreur 500 sur le webhook

1. Activez le debug :
```php
// Dans wp-config.php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
```

2. Consultez `/wp-content/debug.log`

### Les templates ne s'affichent pas

VÃ©rifiez les permissions :
```bash
chmod 644 templates/*.json
```

---

## ğŸ“Š Utilisation

### Shortcode pour formulaire de contact

```php
[email_warmup prefix="support" label="Contactez-nous"]
```

### Afficher des statistiques

```php
[pw_stats type="total"]
[pw_stats type="success_rate"]
```

### Hooks pour dÃ©veloppeurs

```php
// Modifier un payload avant envoi
add_filter('pw_email_payload', function($payload, $template, $vars) {
    $payload['subject'] = 'Mon sujet personnalisÃ©';
    return $payload;
}, 10, 3);

// Action aprÃ¨s envoi
add_action('pw_after_send', function($result, $to, $domain) {
    if ($result['success']) {
        // Faire quelque chose
    }
}, 10, 3);
```

---

## ğŸ‰ FÃ©licitations !

Votre plugin **Postal Warmup Pro** est maintenant :

- âœ… InstallÃ© et fonctionnel
- âœ… ConfigurÃ© avec vos serveurs Postal
- âœ… PrÃªt Ã  recevoir et rÃ©pondre aux emails
- âœ… SurveillÃ© avec logs et stats

## ğŸ“š Documentation ComplÃ¨te

- ğŸ“– [README.md](README.md) - Vue d'ensemble
- ğŸ“– [INSTALLATION.md](INSTALLATION.md) - Guide dÃ©taillÃ©
- ğŸ“– [STRUCTURE.md](STRUCTURE.md) - Architecture technique

---

## ğŸ†˜ Support

Besoin d'aide ?

- ğŸ“§ Email : support@elianova.com
- ğŸ“š Documentation : https://elianova.com/docs/postal-warmup
- ğŸ› Bugs : https://github.com/elianova/postal-warmup/issues

---

**Version** : 2.0.0  
**DerniÃ¨re mise Ã  jour** : 26 janvier 2026  
**Auteur** : Elianova

**Bon warmup ! ğŸš€ğŸ“§**



# ğŸ“§ Guide Complet : Shortcode [warmup_mailto]

## ğŸ¯ Installation

### 1. CrÃ©er les nouveaux fichiers

**Fichiers Ã  crÃ©er :**

1. `includes/class-pw-warmup-mailto.php` (artifact "class-pw-warmup-mailto.php")
2. `public/js/mailto-tracker.js` (artifact "mailto-tracker.js")
3. `admin/partials/mailto-stats.php` (artifact "mailto-stats.php")

### 2. Modifier les fichiers existants

**Dans `includes/class-pw-activator.php`** (fonction `create_tables()`) :

Ajouter aprÃ¨s les autres tables :

```php
// Table des clics mailto
$table_mailto = $wpdb->prefix . 'postal_mailto_clicks';
$sql_mailto = "CREATE TABLE IF NOT EXISTS $table_mailto (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    template VARCHAR(100) NOT NULL,
    server_domain VARCHAR(255) NOT NULL,
    page_url VARCHAR(500) NULL,
    user_agent TEXT NULL,
    ip_address VARCHAR(45) NULL,
    clicked_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_template (template),
    INDEX idx_server (server_domain),
    INDEX idx_clicked_at (clicked_at)
) $charset_collate;";

dbDelta($sql_mailto);
```

**Dans `includes/class-postal-warmup.php`** (fonction `load_dependencies()`) :

Ajouter aprÃ¨s les autres includes :

```php
require_once PW_INCLUDES_DIR . 'class-pw-warmup-mailto.php';
```

**Dans `admin/class-postal-warmup-admin.php`** (fonction `add_admin_menu()`) :

Ajouter un nouveau sous-menu :

```php
// Sous-menu Stats Mailto
add_submenu_page(
    'postal-warmup',
    __('Stats Mailto', 'postal-warmup'),
    __('Stats Mailto', 'postal-warmup'),
    'manage_options',
    'postal-warmup-mailto-stats',
    array($this, 'display_mailto_stats')
);
```

Et ajouter la fonction dans la mÃªme classe :

```php
public function display_mailto_stats() {
    $file = PW_ADMIN_DIR . 'partials/mailto-stats.php';
    if (file_exists($file)) {
        require_once $file;
    }
}
```

**Dans `uninstall.php`** :

Ajouter :

```php
// Supprimer la table des clics mailto
$wpdb->query("DROP TABLE IF EXISTS {$wpdb->prefix}postal_mailto_clicks");
```

### 3. RÃ©activer le plugin

```
WordPress Admin > Extensions > DÃ©sactiver "Postal Warmup Pro"
WordPress Admin > Extensions > Activer "Postal Warmup Pro"
```

---

## ğŸ“ Utilisation du Shortcode

### Syntaxe de Base

```
[warmup_mailto template="nom_du_template"]
```

### Tous les ParamÃ¨tres

```
[warmup_mailto 
    template="support"
    label="Contactez-nous"
    subject="Question importante"
    body="Bonjour,

Je souhaiterais..."
    display="button"
    preset="primary"
    style="font-size: 18px;"
    class="ma-classe-css"
    force_server="check.brith.day"
    track="true"]
```

---

## ğŸ¨ Exemples Concrets

### 1. Bouton Simple

```
[warmup_mailto template="support"]
```

**RÃ©sultat** : Bouton bleu "Nous contacter" â†’ `support@serveur-alÃ©atoire.com`

---

### 2. Avec Sujet PersonnalisÃ©

```
[warmup_mailto template="support" subject="Demande de devis"]
```

---

### 3. Avec Sujet ET Corps

```
[warmup_mailto 
    template="info" 
    subject="Question sur vos services"
    body="Bonjour,

J'aimerais en savoir plus sur vos services.

Cordialement"]
```

---

### 4. Bouton Vert (Preset Success)

```
[warmup_mailto template="contact" preset="success" label="C'est parti !"]
```

---

### 5. Lien Simple (pas de bouton)

```
[warmup_mailto template="support" display="link" label="Ã‰crivez-nous"]
```

---

### 6. Badge Compact

```
[warmup_mailto template="info" display="badge" label="Contact"]
```

---

### 7. Style PersonnalisÃ©

```
[warmup_mailto 
    template="support"
    label="Support 24/7"
    style="background: linear-gradient(45deg, #667eea, #764ba2); padding: 15px 40px; font-size: 20px; text-transform: uppercase;"]
```

---

### 8. Variables Dynamiques

```
[warmup_mailto 
    template="support"
    subject="Question depuis {{page_title}}"
    body="Bonjour,

J'Ã©cris depuis la page : {{page_url}}

Mon nom : {{user_name}}

Question : ..."]
```

---

## ğŸ”§ Variables Dynamiques Disponibles

| Variable | Description | Exemple |
|----------|-------------|---------|
| `{{page_title}}` | Titre de la page actuelle | "Accueil" |
| `{{page_url}}` | URL de la page | "https://site.com/page" |
| `{{site_name}}` | Nom du site | "Mon Site" |
| `{{site_url}}` | URL du site | "https://site.com" |
| `{{date}}` | Date du jour | "26/01/2026" |
| `{{time}}` | Heure actuelle | "18:30" |
| `{{year}}` | AnnÃ©e | "2026" |
| `{{user_name}}` | Nom de l'utilisateur connectÃ© | "John Doe" |
| `{{user_email}}` | Email de l'utilisateur | "john@example.com" |
| `{{user_firstname}}` | PrÃ©nom | "John" |
| `{{user_lastname}}` | Nom | "Doe" |

---

## ğŸ¨ Presets de Style

| Preset | Description | AperÃ§u |
|--------|-------------|--------|
| `primary` | Bleu (dÃ©faut) | ğŸ”µ Bouton bleu |
| `success` | Vert | ğŸŸ¢ Bouton vert |
| `danger` | Rouge | ğŸ”´ Bouton rouge |
| `warning` | Orange | ğŸŸ  Bouton orange |
| `minimal` | Transparent avec bordure | âšª Bordure bleue |
| `gradient` | DÃ©gradÃ© violet | ğŸŸ£ DÃ©gradÃ© moderne |

---

## ğŸ“Š Statistiques & Tracking

### Voir les Stats

Allez dans **Postal Warmup > Stats Mailto**

Vous verrez :
- **Total des clics** sur tous les templates
- **Clics par template** (quel template est le plus populaire)
- **Top 10 pages** (quels articles gÃ©nÃ¨rent le plus de contacts)
- **Graphique d'Ã©volution** des clics

### DÃ©sactiver le Tracking

```
[warmup_mailto template="support" track="false"]
```

---

## ğŸ”„ Rotation des Serveurs

### Comment Ã§a marche ?

1. **Premier chargement** : Un serveur alÃ©atoire est choisi
2. **Cookie 24h** : Le mÃªme serveur est rÃ©utilisÃ© pendant 24h par visiteur
3. **Rotation** : AprÃ¨s 24h, un nouveau serveur est sÃ©lectionnÃ©

### Forcer un Serveur SpÃ©cifique

```
[warmup_mailto template="support" force_server="check.brith.day"]
```

âš ï¸ Pas recommandÃ© car dÃ©sactive la rotation (utile uniquement pour des tests)

---

## ğŸ’¡ Cas d'Usage

### 1. Page de Contact

```
<h2>Contactez-nous</h2>
<p>Vous avez des questions ? N'hÃ©sitez pas !</p>

[warmup_mailto 
    template="contact"
    label="Envoyer un message"
    subject="Contact depuis {{page_title}}"
    preset="gradient"]
```

---

### 2. Article de Blog (Support)

```
<p>Un problÃ¨me ? Notre Ã©quipe est lÃ  pour vous aider !</p>

[warmup_mailto 
    template="support"
    label="Contacter le support"
    subject="Question sur l'article : {{page_title}}"
    body="Bonjour,

J'ai lu l'article : {{page_url}}

Ma question : "
    preset="primary"]
```

---

### 3. Page Tarifs (Demande de Devis)

```
<h3>IntÃ©ressÃ© ? Demandez un devis !</h3>

[warmup_mailto 
    template="sales"
    label="Demander un devis"
    subject="Demande de devis"
    body="Bonjour,

Je souhaite recevoir un devis pour :

- 

Cordialement,
{{user_name}}"
    preset="success"]
```

---

### 4. Sidebar (Lien Discret)

```
<p>
    Besoin d'aide ? 
    [warmup_mailto template="support" display="link" label="Contactez-nous"]
</p>
```

---

### 5. Footer (Badge)

```
Support : [warmup_mailto template="support" display="badge" label="24/7"]
```

---

## ğŸ› DÃ©pannage

### Le bouton ne s'affiche pas

1. VÃ©rifiez que vous avez au moins 1 serveur actif
2. DÃ©sactivez/RÃ©activez le plugin
3. Videz le cache WordPress

### Les clics ne sont pas trackÃ©s

1. VÃ©rifiez que `track="true"` (par dÃ©faut)
2. VÃ©rifiez que jQuery est chargÃ© sur votre site
3. Consultez les logs dans **Postal Warmup > Logs**

### Le serveur ne change jamais

C'est normal ! Le cookie garde le mÃªme serveur pendant 24h pour chaque visiteur.

---

## ğŸ“ˆ Optimisation

### Maximiser les Clics

1. **Placez les boutons stratÃ©giquement** : En haut, milieu ET fin d'article
2. **Utilisez des appels Ã  l'action clairs** : "Posez votre question", "Obtenez de l'aide"
3. **Testez diffÃ©rents styles** : `preset="gradient"` fonctionne souvent mieux
4. **PrÃ©-remplissez intelligemment** : Utilisez les variables dynamiques

### Warmup Optimal

1. **Variez les templates** : Utilisez `support`, `info`, `contact`, `sales`...
2. **Multipliez les placements** : Plus de boutons = plus de diversitÃ© d'IPs
3. **Rotation automatique** : Laissez faire le systÃ¨me !

---

## ğŸ‰ RÃ©sultat Final

Avec ce systÃ¨me, vous avez :

âœ… **Rotation automatique** des serveurs  
âœ… **Tracking des clics** pour optimiser  
âœ… **Variables dynamiques** pour personnaliser  
âœ… **Design flexible** avec presets  
âœ… **Warmup passif** sur tous vos articles  

**Chaque visiteur qui clique utilise potentiellement un serveur diffÃ©rent, maximisant votre warmup ! ğŸš€**